(this["webpackJsonpeog-react-visualization-base"]=this["webpackJsonpeog-react-visualization-base"]||[]).push([[0],{396:function(e,t,r){"use strict";r.r(t);var n=r(22),a=r.n(n),c=r(6),i=r(0),o=r(50),s=r(129),u=r(227),l=r(450),d=r(451),m=r(38),j=r(128),b=r(229),p=r(42),h=r.n(p),f=r(112),O=r(102),v=Object(O.a)({name:"weather",initialState:{temperatureinCelsius:0,temperatureinFahrenheit:0,description:"",locationName:""},reducers:{weatherDataRecevied:function(e,t){var r=t.payload,n=r.description,a=r.locationName,c=r.temperatureinCelsius;e.temperatureinCelsius=c,e.temperatureinFahrenheit=Number((9*c/5+32).toFixed(2)),e.description=n,e.locationName=a},weatherApiErrorReceived:function(e,t){return e}}}),g=v.reducer,x=v.actions,y=h.a.mark(C),w=h.a.mark(M);function C(e){return h.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.a)(s.b.error,"Error Received: ".concat(e.payload.error));case 2:case"end":return t.stop()}}),y)}function M(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.c)(x.weatherApiErrorReceived.type,C);case 2:case"end":return e.stop()}}),w)}var k=h.a.mark(N);function N(){return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.b)(M);case 2:case"end":return e.stop()}}),k)}var E,S=Object(O.a)({name:"metrics",initialState:{metrics:["flareTemp","injValveOpen","oilTemp","casingPressure","tubingPressure","waterTemp"],selectedMetrics:[]},reducers:{metricsReceived:function(e,t){e.metrics=t.payload},selectedMetrics:function(e,t){e.selectedMetrics=t.payload},metricsApiErrorReceived:function(e,t){alert(t.payload.error)}}}),T=S.reducer,A=S.actions,R={weather:g,metrics:T},q=Object(m.combineReducers)(R),W=(r(257),r(439)),L=r(436),V=r(437),D=r(435),F=r(231),B=r(438),I=r(28),U=r(125),P=r(41),z=r(459),$=r(434),G=r(458),H=r(9),_=Object(H.a)((function(e){return{root:{background:e.palette.secondary.main},label:{color:e.palette.primary.main}}}))(G.a),J=Object(U.a)({url:"https://react.eogresources.com/graphql"}),K=function(e){var t=e.weather;return{temperatureinFahrenheit:t.temperatureinFahrenheit,description:t.description,locationName:t.locationName}},Q=function(){return Object(c.jsx)(P.a,{value:J,children:Object(c.jsx)(X,{})})},X=function(){var e=Object(z.a)(),t={latitude:e.latitude||29.7604,longitude:e.longitude||-95.3698},r=Object(o.b)(),n=Object(o.c)(K),a=n.temperatureinFahrenheit,s=n.description,u=n.locationName,l=Object(P.b)({query:"\nquery($latLong: WeatherQuery!) {\n  getWeatherForLocation(latLong: $latLong) {\n    description\n    locationName\n    temperatureinCelsius\n  }\n}\n",variables:{latLong:t}}),d=Object(I.a)(l,1)[0],m=d.fetching,j=d.data,b=d.error;return Object(i.useEffect)((function(){if(b)r(x.weatherApiErrorReceived({error:b.message}));else if(j){var e=j.getWeatherForLocation;r(x.weatherDataRecevied(e))}}),[r,j,b]),m?Object(c.jsx)($.a,{}):Object(c.jsx)(_,{label:"Weather in ".concat(u,": ").concat(s," and ").concat(a,"\xb0")})},Y=Object(F.a)("div")((function(e){var t=e.theme;return{display:"flex",justifyContent:"center",[t.breakpoints.up("md")]:{justifyContent:"end"},[t.breakpoints.down("sm")]:{paddingBottom:"1rem"}}})),Z=Object(F.a)("div")((function(e){return{display:"flex",height:"100%",alignItems:"center",[e.theme.breakpoints.down("sm")]:{justifyContent:"center",textAlign:"center",paddingTop:".6rem",paddingBottom:".5rem"}}})),ee=Object(D.a)({title:{lineHeight:"normal"}}),te=function(){var e=ee();return Object(c.jsx)(L.a,{position:"static",children:Object(c.jsx)(V.a,{children:Object(c.jsxs)(B.a,{container:!0,children:[Object(c.jsx)(B.a,{item:!0,xs:12,md:6,children:Object(c.jsx)(Z,{children:Object(c.jsxs)(W.a,{variant:"h6",color:"inherit",className:e.title,children:["Gerardo's","EOG React Visualization Assessment"]})})}),Object(c.jsx)(B.a,{item:!0,xs:12,md:6,children:Object(c.jsx)(Y,{children:Object(c.jsx)(Q,{})})})]})})})},re=Object(D.a)({wrapper:{height:"100vh"}}),ne=function(e){var t=e.children,r=re();return Object(c.jsx)("div",{className:r.wrapper,children:t})},ae=r(64),ce=r(442),ie=r(449),oe=r(454),se=r(440),ue=r(460),le=r(452),de=r(441),me=r(461),je=Object(D.a)({formControl:{minWidth:180},inputLabel:{color:"black"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2,backgroundColor:"white"}}),be=function(e){var t=e.values,r=void 0===t?["No metrics"]:t,n=e.changeCallback,a=Object(i.useState)([]),o=Object(I.a)(a,2),s=o[0],u=o[1],l=je();return Object(c.jsxs)(se.a,{className:l.formControl,children:[Object(c.jsx)(ue.a,{className:l.inputLabel,id:"mutiple-metric-label",children:"Select metric..."}),Object(c.jsx)(le.a,{labelId:"mutiple-metric-label",id:"mutiple-metric",multiple:!0,value:s,onChange:function(e){u(e.target.value),n(e.target.value)},input:Object(c.jsx)(de.a,{}),renderValue:function(e){return Object(c.jsx)("div",{className:l.chips,children:e.map((function(e){return Object(c.jsx)(G.a,{label:e,className:l.chip},"multipleSelect_".concat(e))}))})},children:r.map((function(e){return Object(c.jsx)(me.a,{value:e,children:e},"menuItem_".concat(e))}))})]})},pe=r(214);!function(e){e.flareTemp="green",e.injValveOpen="blue",e.oilTemp="red",e.casingPressure="black",e.tubingPressure="pink",e.waterTemp="purple"}(E||(E={}));var he=new pe.SubscriptionClient("wss://react.eogresources.com/graphql",{reconnect:!0}),fe=Object(U.a)({url:"https://react.eogresources.com/graphql",exchanges:[].concat(Object(ae.a)(U.b),[Object(U.c)({forwardSubscription:function(e){return he.request(e)}})])}),Oe=function(e){return E[e]||"#".concat(Math.floor(16777215*Math.random()).toString(16))},ve=Object(D.a)({selectContainer:{marginBottom:20,marginTop:20},circularProgressWrapper:{textAlign:"center",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}),ge=Object(U.a)({url:"https://react.eogresources.com/graphql"}),xe=function(e){return{metrics:e.metrics.metrics}},ye=function(){var e=ve(),t=Object(o.b)(),r=Object(o.c)(xe).metrics,n=Object(P.b)({query:"\nquery {\n  getMetrics\n}\n"}),a=Object(I.a)(n,1)[0],s=a.fetching,u=a.data,l=a.error;return Object(i.useEffect)((function(){l?t(A.metricsApiErrorReceived({error:"".concat(l.message,"\nUsing default metrics for selection")})):u&&t(A.metricsReceived(u.getMetrics))}),[t,u,l]),s?Object(c.jsx)(oe.a,{className:e.circularProgressWrapper,children:Object(c.jsx)(ce.a,{})}):Object(c.jsx)(oe.a,{className:e.selectContainer,children:Object(c.jsx)(be,{values:r,changeCallback:function(e){t(A.selectedMetrics(e.map((function(e){return{metric:e,color:Oe(e)}}))))}})})},we=function(){return Object(c.jsx)(P.a,{value:ge,children:Object(c.jsx)(ye,{})})},Ce=r(456),Me=r(453),ke=r(446),Ne=r(225),Ee=r(145),Se=r(230),Te=r(226),Ae=function(e){var t=e.active,r=e.payload;if(t&&r&&r.length){var n=new Date(r[0].payload.milliseconds).toUTCString(),a=[];return r.forEach((function(e){var t="".concat(e.name,": ").concat(e.value);a.push(Object(c.jsx)("p",{style:{margin:"0px 0px",color:e.color},children:t},e.name))})),Object(c.jsxs)("div",{style:{backgroundColor:"white",padding:"1% 5% 8%",borderRadius:"5px"},children:[Object(c.jsx)("p",{children:"".concat(n)}),a.map((function(e){return e}))]})}return null};Ae.defaultProps={active:!1,payload:[]};var Re=function(e){var t=e.data,r=e.metricUnits;return r.forEach((function(e){e.render=!1;var r=null===t||void 0===t?void 0:t.map((function(t){return t[e.metric]}));e.min=r.reduce((function(e,t){return e<t?e:t}))})),r.forEach((function(e){var t=r.filter((function(t){return t.unit===e.unit})),n=(null===t||void 0===t?void 0:t.length)>1?null===t||void 0===t?void 0:t.reduce((function(e,t){return e.min<t.min?e:t})):t[0],a=r.find((function(e){return e.metric===n.metric&&e.unit===n.unit}));a&&(a.render=!0)})),Object(c.jsx)(Ce.a,{height:400,children:Object(c.jsxs)(Me.a,{margin:{top:5,right:30,left:20,bottom:15},data:t,children:[Object(c.jsx)(ke.a,{strokeDasharray:"3 3"}),Object(c.jsx)(Ne.a,{interval:"preserveStart",dataKey:"at",dy:5,tickSize:4,tick:{fontSize:12}}),Object(c.jsx)(Ee.a,{content:Object(c.jsx)(Ae,{})}),Object(c.jsx)(Ee.a,{}),null===r||void 0===r?void 0:r.map((function(e,t){return Object(c.jsx)(Se.a,{stroke:e.color,dot:!1,yAxisId:t,isAnimationActive:!1,type:"monotone",dataKey:e.metric},"".concat(e.metric,"XAxis"))})),null===r||void 0===r?void 0:r.map((function(e,t){return Object(c.jsx)(Te.a,{hide:!e.render,tickCount:10,label:{value:e.unit,angle:-90,position:"insideTopLeft"},yAxisId:t,dx:-5},"".concat(e.metric,"YAxis"))}))]})})},qe=r(447),We=r(448),Le=Object(D.a)({cardsConteiner:{paddingBottom:"1%"},cardContent:{paddingTop:"2%",paddingRight:"5%",paddingBottom:"1%",paddingLeft:"5%","&:last-child":{paddingBottom:"0px"}}}),Ve=function(e){var t=e.measure,r=Le();return Object(c.jsx)(B.a,{xs:6,sm:4,md:3,item:!0,children:Object(c.jsx)(qe.a,{children:Object(c.jsxs)(We.a,{className:r.cardContent,children:[Object(c.jsx)(W.a,{noWrap:!0,variant:"subtitle1",children:"".concat(t.metric," (").concat(t.unit,")")}),Object(c.jsx)(W.a,{style:{color:"".concat(t.color)},variant:"h4",children:t.lastMeasure})]})})},"grid_".concat(t.metric))},De=function(e){var t=e.bodyVariant,r=e.headerVariant,n=e.color,a=e.header,i=e.body;return Object(c.jsxs)("div",{children:[Object(c.jsx)(W.a,{variant:r,color:n,children:a}),Object(c.jsx)(W.a,{variant:t,children:i})]})};function Fe(e){var t=Object(i.useState)(e.map((function(e){return{metric:e.metric,lastMeasure:null,unit:null,color:e.color}}))),r=Object(I.a)(t,2),n=r[0],a=r[1];return Object(i.useEffect)((function(){if(e.length<n.length){var t=e.map((function(e){return e.metric})),r=n.map((function(e){return e.metric})),c=new Set(t),i=function(e,t){var r=new Set(e);return t.forEach((function(e){r.delete(e)})),r}(new Set(r),c),o=Object(ae.a)(i)[0];a(n.filter((function(e){return e.metric!==o})))}}),[e]),[n,a]}var Be=function(e){return{selectedMetrics:e.metrics.selectedMetrics}},Ie=Object(D.a)({cardsConteiner:{paddingBottom:"1%"},dashboardContainer:{height:"100%"}}),Ue={id:(new Date).getTime(),at:"",milliseconds:0},Pe=function(){var e=Ie(),t=Object(P.c)({query:"\n  subscription NewMeasurementSub {\n    newMeasurement {\n      metric\n      value\n      unit\n      at\n    }\n  }\n"}),r=Object(I.a)(t,1)[0],n=Object(i.useState)([]),a=Object(I.a)(n,2),s=a[0],u=a[1],l=Object(i.useState)([]),d=Object(I.a)(l,2),m=d[0],j=d[1],b=Object(o.c)(Be).selectedMetrics,p=b.map((function(e){return{metricName:e.metric}})),h=Fe(b),f=Object(I.a)(h,2),O=f[0],v=f[1],g=function(e){var t=Object(P.b)({query:"\n  query ($input: [MeasurementQuery]) {\n    getMultipleMeasurements(input: $input) {\n      metric\n      measurements {\n        metric\n        unit\n        value\n        at\n      }\n    }\n  }\n",variables:{input:e}});return Object(I.a)(t,1)[0]}(p),x=g.data,y=g.fetching,w=g.error,C=x,M=r.data,k=r.error;Object(i.useEffect)((function(){var e;C=null===(e=C)||void 0===e?void 0:e.getMultipleMeasurements,j(function(e){var t=[];if(0!==(null===e||void 0===e?void 0:e.length))for(var r=0;r<(null===e||void 0===e?void 0:e.length);r+=1)t.push({metric:e[r].metric,unit:e[r].measurements[0].unit,color:Oe(e[r].metric),min:0,render:!0});return t}(C)),u(function(e,t){var r=[];if(0!==(null===e||void 0===e?void 0:e.length))for(var n,a=0,c=0;c<(null===e||void 0===e?void 0:e.length);c+=1){for(var i=(e[c].measurements.length,e[c].measurements.length-t);i<e[c].measurements.length;i+=1)r[a]=r[a]||{},r[a][e[c].metric]=e[c].measurements[i].value,n=new Date(e[c].measurements[i].at),r[a].at="".concat(n.getUTCHours(),":").concat(n.getUTCMinutes()),r[a].milliseconds=e[c].measurements[i].at,a+=1;a=0}return r}(C,1e3))}),[C]),Object(i.useEffect)((function(){if(M){var e=M.newMeasurement,t=new Date(null===e||void 0===e?void 0:e.at);if(Ue[e.metric]){var r=function(e,t,r){var n={id:t.id,at:t.at,milliseconds:t.milliseconds};return r.forEach((function(e){n[e.metric]=t[e.metric]})),[].concat(Object(ae.a)(e),[n])}(s,Ue,b);r.length!==s.length&&u(r.slice()),Ue={id:(new Date).getTime(),at:"",milliseconds:0}}else{Ue[e.metric]=e.value,Ue.milliseconds=e.at,Ue.at="".concat(t.getUTCHours(),":").concat(t.getUTCMinutes());var n=b.find((function(t){return t.metric===e.metric})),a=O.find((function(t){return t.metric===e.metric}));if(n)if(a){var c=O.indexOf(a),i=Object(ae.a)(O);i.splice(c,1,{lastMeasure:e.value,metric:e.metric,unit:e.unit,color:a.color}),v(i)}else v([].concat(Object(ae.a)(O),[{lastMeasure:e.value,metric:e.metric,unit:e.unit,color:n.color}]))}}}),[M]);var N=w?Object(c.jsx)(De,{bodyVariant:"body1",body:w.message,color:"error",headerVariant:"h6",header:"Error while getting multiple measurements:"}):Object(c.jsx)(Re,{metricUnits:m,data:s}),E=y?Object(c.jsx)(ce.a,{}):N,S=k?Object(c.jsx)(De,{bodyVariant:"body1",body:k.message,color:"error",headerVariant:"h6",header:"Error while getting real time last measures:"}):Object(c.jsx)(B.a,{container:!0,spacing:2,className:e.cardsConteiner,children:O.map((function(e){return Object(c.jsx)(Ve,{measure:e},e.metric)}))});return Object(c.jsxs)(ie.a,{className:e.dashboardContainer,maxWidth:"lg",children:[Object(c.jsxs)(oe.a,{sx:{padding:"2% 0%",textAlign:"center"},children:[Object(c.jsx)(W.a,{variant:"h6",children:"EOG Task"}),Object(c.jsx)(W.a,{variant:"subtitle1",children:"Select some metrics to get started:"})]}),Object(c.jsx)(we,{}),S,Object(c.jsx)(oe.a,{pt:2,pb:3,alignItems:"center",justifyContent:"center",display:"flex",children:0!==b.length&&E})]})},ze=function(){return Object(c.jsx)(P.a,{value:fe,children:Object(c.jsx)(Pe,{})})},$e=function(){var e=Object(j.composeWithDevTools)({}),t=Object(b.a)(),r=Object(m.applyMiddleware)(t),n=Object(m.createStore)(q,e(r));return t.run(N),n}(),Ge=Object(u.a)({palette:{primary:{main:"rgb(39,49,66)"},secondary:{main:"rgb(197,208,222)"},background:{default:"rgb(226,231,238)"}}}),He=function(){return Object(c.jsxs)(l.a,{theme:Ge,children:[Object(c.jsx)(d.a,{}),Object(c.jsx)(o.a,{store:$e,children:Object(c.jsx)(ne,{children:Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(te,{}),Object(c.jsx)(s.a,{}),Object(c.jsx)(ze,{})]})})})]})};a.a.render(He(),document.getElementById("root"))}},[[396,1,2]]]);
//# sourceMappingURL=main.93825cde.chunk.js.map