(this["webpackJsonpeog-react-visualization-base"]=this["webpackJsonpeog-react-visualization-base"]||[]).push([[0],{395:function(e,t,r){"use strict";r.r(t);var n=r(22),a=r.n(n),c=r(8),i=r(0),o=r(50),s=r(129),u=r(227),l=r(449),d=r(450),m=r(38),j=r(128),b=r(229),h=r(42),p=r.n(h),f=r(111),O=r(101),v=Object(O.a)({name:"weather",initialState:{temperatureinCelsius:0,temperatureinFahrenheit:0,description:"",locationName:""},reducers:{weatherDataRecevied:function(e,t){var r=t.payload,n=r.description,a=r.locationName,c=r.temperatureinCelsius;e.temperatureinCelsius=c,e.temperatureinFahrenheit=9*c/5+32,e.description=n,e.locationName=a},weatherApiErrorReceived:function(e,t){return e}}}),g=v.reducer,x=v.actions,y=p.a.mark(C),w=p.a.mark(M);function C(e){return p.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(f.a)(s.b.error,"Error Received: ".concat(e.payload.error));case 2:case"end":return t.stop()}}),y)}function M(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.c)(x.weatherApiErrorReceived.type,C);case 2:case"end":return e.stop()}}),w)}var E=p.a.mark(N);function N(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.b)(M);case 2:case"end":return e.stop()}}),E)}var S,k=Object(O.a)({name:"metrics",initialState:{metrics:["flareTemp","injValveOpen","oilTemp","casingPressure","tubingPressure","waterTemp"],selectedMetrics:[]},reducers:{metricsReceived:function(e,t){e.metrics=t.payload},selectedMetrics:function(e,t){e.selectedMetrics=t.payload},metricsApiErrorReceived:function(e,t){alert(t.payload.error)}}}),T=k.reducer,A=k.actions,R={weather:g,metrics:T},q=Object(m.combineReducers)(R),V=(r(256),r(437)),W=r(435),D=r(436),L=r(434),F=r(28),U=r(125),I=r(41),P=r(458),z=r(433),B=r(457),G=r(9),$=Object(G.a)((function(e){return{root:{background:e.palette.secondary.main},label:{color:e.palette.primary.main}}}))(B.a),_=Object(U.a)({url:"https://react.eogresources.com/graphql"}),H=function(e){var t=e.weather;return{temperatureinFahrenheit:t.temperatureinFahrenheit,description:t.description,locationName:t.locationName}},J=function(){return Object(c.jsx)(I.a,{value:_,children:Object(c.jsx)(K,{})})},K=function(){var e=Object(P.a)(),t={latitude:e.latitude||29.7604,longitude:e.longitude||-95.3698},r=Object(o.b)(),n=Object(o.c)(H),a=n.temperatureinFahrenheit,s=n.description,u=n.locationName,l=Object(I.b)({query:"\nquery($latLong: WeatherQuery!) {\n  getWeatherForLocation(latLong: $latLong) {\n    description\n    locationName\n    temperatureinCelsius\n  }\n}\n",variables:{latLong:t}}),d=Object(F.a)(l,1)[0],m=d.fetching,j=d.data,b=d.error;return Object(i.useEffect)((function(){if(b)r(x.weatherApiErrorReceived({error:b.message}));else if(j){var e=j.getWeatherForLocation;r(x.weatherDataRecevied(e))}}),[r,j,b]),m?Object(c.jsx)(z.a,{}):Object(c.jsx)($,{label:"Weather in ".concat(u,": ").concat(s," and ").concat(a,"\xb0")})},Q=Object(L.a)({grow:{flexGrow:1}}),X=function(){var e=Q();return Object(c.jsx)(W.a,{position:"static",children:Object(c.jsxs)(D.a,{children:[Object(c.jsxs)(V.a,{variant:"h6",color:"inherit",className:e.grow,children:["Gerardo's","EOG React Visualization Assessment"]}),Object(c.jsx)(J,{})]})})},Y=Object(L.a)({wrapper:{height:"100vh"}}),Z=function(e){var t=e.children,r=Y();return Object(c.jsx)("div",{className:r.wrapper,children:t})},ee=r(64),te=r(440),re=r(445),ne=r(448),ae=r(452),ce=r(438),ie=r(459),oe=r(451),se=r(439),ue=r(460),le=Object(L.a)({formControl:{minWidth:180},inputLabel:{color:"black"},chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2,backgroundColor:"white"}}),de=function(e){var t=e.values,r=void 0===t?["No metrics"]:t,n=e.changeCallback,a=Object(i.useState)([]),o=Object(F.a)(a,2),s=o[0],u=o[1],l=le();return Object(c.jsxs)(ce.a,{className:l.formControl,children:[Object(c.jsx)(ie.a,{className:l.inputLabel,id:"mutiple-metric-label",children:"Select metric..."}),Object(c.jsx)(oe.a,{labelId:"mutiple-metric-label",id:"mutiple-metric",multiple:!0,value:s,onChange:function(e){u(e.target.value),n(e.target.value)},input:Object(c.jsx)(se.a,{}),renderValue:function(e){return Object(c.jsx)("div",{className:l.chips,children:e.map((function(e){return Object(c.jsx)(B.a,{label:e,className:l.chip},"multipleSelect_".concat(e))}))})},children:r.map((function(e){return Object(c.jsx)(ue.a,{value:e,children:e},"menuItem_".concat(e))}))})]})},me=r(214);!function(e){e.flareTemp="green",e.injValveOpen="blue",e.oilTemp="red",e.casingPressure="black",e.tubingPressure="pink",e.waterTemp="purple"}(S||(S={}));var je=new me.SubscriptionClient("wss://react.eogresources.com/graphql",{reconnect:!0}),be=Object(U.a)({url:"https://react.eogresources.com/graphql",exchanges:[].concat(Object(ee.a)(U.b),[Object(U.c)({forwardSubscription:function(e){return je.request(e)}})])}),he=function(e){return S[e]||"#".concat(Math.floor(16777215*Math.random()).toString(16))},pe=Object(L.a)({selectContainer:{marginBottom:20,marginTop:20},circularProgressWrapper:{textAlign:"center",height:"100%",display:"flex",justifyContent:"center",alignItems:"center"}}),fe=Object(U.a)({url:"https://react.eogresources.com/graphql"}),Oe=function(e){return{metrics:e.metrics.metrics}},ve=function(){var e=pe(),t=Object(o.b)(),r=Object(o.c)(Oe).metrics,n=Object(I.b)({query:"\nquery {\n  getMetrics\n}\n"}),a=Object(F.a)(n,1)[0],s=a.fetching,u=a.data,l=a.error;return Object(i.useEffect)((function(){l?t(A.metricsApiErrorReceived({error:"".concat(l.message,"\nUsing default metrics for selection")})):u&&t(A.metricsReceived(u.getMetrics))}),[t,u,l]),s?Object(c.jsx)(ae.a,{className:e.circularProgressWrapper,children:Object(c.jsx)(te.a,{})}):Object(c.jsx)(ae.a,{className:e.selectContainer,children:Object(c.jsx)(de,{values:r,changeCallback:function(e){t(A.selectedMetrics(e.map((function(e){return{metric:e,color:he(e)}}))))}})})},ge=function(){return Object(c.jsx)(I.a,{value:fe,children:Object(c.jsx)(ve,{})})},xe=r(455),ye=r(453),we=r(444),Ce=r(225),Me=r(145),Ee=r(230),Ne=r(226),Se=function(e){var t=e.active,r=e.payload;if(t&&r&&r.length){var n=new Date(r[0].payload.milliseconds).toUTCString(),a=[];return r.forEach((function(e){var t="".concat(e.name,": ").concat(e.value);a.push(Object(c.jsx)("p",{style:{margin:"0px 0px",color:e.color},children:t},e.name))})),Object(c.jsxs)("div",{style:{backgroundColor:"white",padding:"1% 5% 8%",borderRadius:"5px"},children:[Object(c.jsx)("p",{children:"".concat(n)}),a.map((function(e){return e}))]})}return null};Se.defaultProps={active:!1,payload:[]};var ke=function(e){var t=e.data,r=e.metricUnits;return r.forEach((function(e){e.render=!1;var r=null===t||void 0===t?void 0:t.map((function(t){return t[e.metric]}));e.min=r.reduce((function(e,t){return e<t?e:t}))})),r.forEach((function(e){var t=r.filter((function(t){return t.unit===e.unit})),n=(null===t||void 0===t?void 0:t.length)>1?null===t||void 0===t?void 0:t.reduce((function(e,t){return e.min<t.min?e:t})):t[0],a=r.find((function(e){return e.metric===n.metric&&e.unit===n.unit}));a&&(a.render=!0)})),Object(c.jsx)(xe.a,{width:"100%",height:400,children:Object(c.jsxs)(ye.a,{margin:{top:5,right:30,left:20,bottom:15},data:t,children:[Object(c.jsx)(we.a,{strokeDasharray:"3 3"}),Object(c.jsx)(Ce.a,{interval:"preserveStart",dataKey:"at",dy:5,tickSize:4,tick:{fontSize:12}}),Object(c.jsx)(Me.a,{content:Object(c.jsx)(Se,{})}),Object(c.jsx)(Me.a,{}),null===r||void 0===r?void 0:r.map((function(e,t){return Object(c.jsx)(Ee.a,{stroke:e.color,dot:!1,yAxisId:t,isAnimationActive:!1,type:"monotone",dataKey:e.metric},"".concat(e.metric,"XAxis"))})),null===r||void 0===r?void 0:r.map((function(e,t){return Object(c.jsx)(Ne.a,{hide:!e.render,tickCount:10,label:{value:e.unit,angle:-90,position:"insideTopLeft"},yAxisId:t,dx:-5},"".concat(e.metric,"YAxis"))}))]})})},Te=r(446),Ae=r(447),Re=Object(L.a)({cardsConteiner:{paddingBottom:"1%"},cardContent:{padding:"5%",paddingRight:"10%"}}),qe=function(e){var t=e.measure,r=Re();return Object(c.jsx)(re.a,{xs:6,sm:4,md:3,item:!0,children:Object(c.jsx)(Te.a,{children:Object(c.jsxs)(Ae.a,{className:r.cardContent,children:[Object(c.jsx)(V.a,{variant:"h6",children:"".concat(t.metric," (").concat(t.unit,")")}),Object(c.jsx)(V.a,{style:{color:"".concat(t.color)},variant:"h3",children:t.lastMeasure})]})})},"grid_".concat(t.metric))},Ve=function(e){var t=e.bodyVariant,r=e.headerVariant,n=e.color,a=e.header,i=e.body;return Object(c.jsxs)("div",{children:[Object(c.jsx)(V.a,{variant:r,color:n,children:a}),Object(c.jsx)(V.a,{variant:t,children:i})]})};function We(e){var t=Object(i.useState)(e.map((function(e){return{metric:e.metric,lastMeasure:null,unit:null,color:e.color}}))),r=Object(F.a)(t,2),n=r[0],a=r[1];return Object(i.useEffect)((function(){if(e.length<n.length){var t=e.map((function(e){return e.metric})),r=n.map((function(e){return e.metric})),c=new Set(t),i=function(e,t){var r=new Set(e);return t.forEach((function(e){r.delete(e)})),r}(new Set(r),c),o=Object(ee.a)(i)[0];a(n.filter((function(e){return e.metric!==o})))}}),[e]),[n,a]}var De=function(e){return{selectedMetrics:e.metrics.selectedMetrics}},Le=Object(L.a)({cardsConteiner:{paddingBottom:"1%"},dashboardContainer:{height:"100%"}}),Fe={id:(new Date).getTime(),at:"",milliseconds:0},Ue=function(){var e=Le(),t=Object(I.c)({query:"\n  subscription NewMeasurementSub {\n    newMeasurement {\n      metric\n      value\n      unit\n      at\n    }\n  }\n"}),r=Object(F.a)(t,1)[0],n=Object(i.useState)([]),a=Object(F.a)(n,2),s=a[0],u=a[1],l=Object(i.useState)([]),d=Object(F.a)(l,2),m=d[0],j=d[1],b=Object(o.c)(De).selectedMetrics,h=b.map((function(e){return{metricName:e.metric}})),p=We(b),f=Object(F.a)(p,2),O=f[0],v=f[1],g=function(e){var t=Object(I.b)({query:"\n  query ($input: [MeasurementQuery]) {\n    getMultipleMeasurements(input: $input) {\n      metric\n      measurements {\n        metric\n        unit\n        value\n        at\n      }\n    }\n  }\n",variables:{input:e}});return Object(F.a)(t,1)[0]}(h),x=g.data,y=g.fetching,w=g.error,C=x,M=r.data,E=r.error;Object(i.useEffect)((function(){var e;C=null===(e=C)||void 0===e?void 0:e.getMultipleMeasurements,j(function(e){var t=[];if(0!==(null===e||void 0===e?void 0:e.length))for(var r=0;r<(null===e||void 0===e?void 0:e.length);r+=1)t.push({metric:e[r].metric,unit:e[r].measurements[0].unit,color:he(e[r].metric),min:0,render:!0});return t}(C)),u(function(e,t){var r=[];if(0!==(null===e||void 0===e?void 0:e.length))for(var n,a=0,c=0;c<(null===e||void 0===e?void 0:e.length);c+=1){for(var i=e[c].measurements.length-t;i<e[c].measurements.length;i+=1)r[a]=r[a]||{},r[a][e[c].metric]=e[c].measurements[i].value,n=new Date(e[c].measurements[i].at),r[a].at="".concat(n.getUTCHours(),":").concat(n.getUTCMinutes()),r[a].milliseconds=e[c].measurements[i].at,a+=1;a=0}return r}(C,1e3))}),[C]),Object(i.useEffect)((function(){if(M){var e=M.newMeasurement,t=new Date(null===e||void 0===e?void 0:e.at);if(Fe[e.metric]){var r=function(e,t,r){var n={id:t.id,at:t.at,milliseconds:t.milliseconds};return r.forEach((function(e){n[e.metric]=t[e.metric]})),[].concat(Object(ee.a)(e),[n])}(s,Fe,b);r.length!==s.length&&u(r.slice()),Fe={id:(new Date).getTime(),at:"",milliseconds:0}}else{Fe[e.metric]=e.value,Fe.milliseconds=e.at,Fe.at="".concat(t.getUTCHours(),":").concat(t.getUTCMinutes());var n=b.find((function(t){return t.metric===e.metric})),a=O.find((function(t){return t.metric===e.metric}));if(n)if(a){var c=O.indexOf(a),i=Object(ee.a)(O);i.splice(c,1,{lastMeasure:e.value,metric:e.metric,unit:e.unit,color:a.color}),v(i)}else v([].concat(Object(ee.a)(O),[{lastMeasure:e.value,metric:e.metric,unit:e.unit,color:n.color}]))}}}),[M]);var N=w?Object(c.jsx)(Ve,{bodyVariant:"body1",body:w.message,color:"error",headerVariant:"h6",header:"Error while getting multiple measurements:"}):Object(c.jsx)(ke,{metricUnits:m,data:s}),S=y?Object(c.jsx)(te.a,{}):N,k=E?Object(c.jsx)(Ve,{bodyVariant:"body1",body:E.message,color:"error",headerVariant:"h6",header:"Error while getting real time last measures:"}):Object(c.jsx)(re.a,{container:!0,spacing:2,className:e.cardsConteiner,children:O.map((function(e){return Object(c.jsx)(qe,{measure:e},e.metric)}))});return Object(c.jsxs)(ne.a,{className:e.dashboardContainer,maxWidth:"lg",children:[Object(c.jsxs)(ae.a,{sx:{padding:"2% 0%",textAlign:"center"},children:[Object(c.jsx)(V.a,{variant:"h4",children:"EOG Task"}),Object(c.jsx)(V.a,{variant:"h5",children:"Select some metrics to get started:"})]}),Object(c.jsx)(ge,{}),k,Object(c.jsx)(ae.a,{pt:2,pb:3,alignItems:"center",justifyContent:"center",display:"flex",children:0!==b.length&&S})]})},Ie=function(){return Object(c.jsx)(I.a,{value:be,children:Object(c.jsx)(Ue,{})})},Pe=function(){var e=Object(j.composeWithDevTools)({}),t=Object(b.a)(),r=Object(m.applyMiddleware)(t),n=Object(m.createStore)(q,e(r));return t.run(N),n}(),ze=Object(u.a)({palette:{primary:{main:"rgb(39,49,66)"},secondary:{main:"rgb(197,208,222)"},background:{default:"rgb(226,231,238)"}}}),Be=function(){return Object(c.jsxs)(l.a,{theme:ze,children:[Object(c.jsx)(d.a,{}),Object(c.jsx)(o.a,{store:Pe,children:Object(c.jsx)(Z,{children:Object(c.jsxs)(c.Fragment,{children:[Object(c.jsx)(X,{}),Object(c.jsx)(s.a,{}),Object(c.jsx)(Ie,{})]})})})]})};a.a.render(Be(),document.getElementById("root"))}},[[395,1,2]]]);
//# sourceMappingURL=main.b4be9727.chunk.js.map